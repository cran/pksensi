<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Nan-Hung Hsieh" />

<meta name="date" content="2019-05-29" />

<title>One-compartment PBTK model</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' || rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">One-compartment PBTK model</h1>
<h4 class="author">Nan-Hung Hsieh</h4>
<h4 class="date">2019-05-29</h4>



<div id="equations" class="section level2">
<h2>Equations</h2>
<p>In this example, We use a simple, one-compartment PK model from <code>httk</code> package <span class="citation">(Pearce et al. 2017)</span> to demonstrate how <code>pksensi</code> can be applied to pharmacokinetic studies. The differential equations for the one-compartment pharmacokinetic model can be written as:</p>
<p><span class="math display">\[\frac{dA_{gutlumen}}{dt} = -k_{gutabs} \cdot A_{gutlumen} + g(t)\]</span> <span class="math display">\[\frac{dC_{rest}}{dt} = \frac{k_{gutabs}}{V_{dist}}-k_{elim} \cdot C_{rest}\]</span></p>
<p>where <span class="math inline">\(A_{gutlumen}\)</span> is the state variable that describes the quantity of compound in gut lumen (mol), <span class="math inline">\(k_{gutabs}\)</span> is the absorption rate constant that describes the chemical absorption from the gut lumen into gut tissue through first-order processes (/h), <span class="math inline">\(V_{dist}\)</span> is the volume of distribution (L), and <span class="math inline">\(k_{elim}\)</span> is the elimination rate constant (/h), which is equal to the total clearance divided by the volume of distribution. The time-dependent function <span class="math inline">\(g(t)\)</span> is used to describe the oral dosing schedule. <span class="math inline">\(C_{rest}\)</span> is the chemical concentration in plasma that can be used to compare with observed results in a pharmacokinetic experiment (mol/L).</p>
</div>
<div id="model-implementations-with-r-desolve-package" class="section level2">
<h2>Model implementations with R deSolve package</h2>
<p>In the beginning, we need to pre-install GNU MCSim <span class="citation">(Bois and Maszle 1997)</span> and related compiler to let us generate .c file and executable file. The GNU MCSim can be installed by following the instruction in GNU MCSim’s manual on <a href="https://www.gnu.org/software/mcsim/mcsim.html" class="uri">https://www.gnu.org/software/mcsim/mcsim.html</a> or using the build-in function <code>mcsim_install()</code> in <code>pksensi</code>. The GNU compiler is necessary for users that use Linux or MacOS. For Windows users, you should install Rtools on <a href="https://cran.r-project.org/bin/windows/Rtools/" class="uri">https://cran.r-project.org/bin/windows/Rtools/</a> and use <code>Sys.setenv()</code> to set the working path of compiler. The <code>Sys.which(&quot;gcc&quot;)</code> and <code>system(&#39;g++ -v&#39;)</code> can check whether we can run compiler correctly.</p>
<p>We first implemented this model in R by compiling the file written in C. pksensi allows users to select the preferred method to solve the pharmacokinetic model, either with the <code>deSolve</code> package or with GNU MCSim through the compile function. However, running model under GNU MCSim native code can have faster speed to obtain the model outputs.</p>
<p>The following R script can download and compile the model description file (<code>pbtk1cpt.model</code>) and use <code>deSolve</code> package <span class="citation">(Soetaert, Petzoldt, and Setzer 2010)</span> to solve ordinary differential equations in our model. The example model code of one-compartment PBTK model is available with pksensi package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="kw">pbtk1cpt_model</span>()</a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw">cat</span>(<span class="kw">readLines</span>(<span class="st">&quot;pbtk1cpt.model&quot;</span>), <span class="dt">sep =</span> <span class="st">&quot;</span><span class="ch">\n</span><span class="st">&quot;</span>)</a></code></pre></div>
<p>Then, use <code>compile_model()</code> to generate the executable files (<code>pbtk1cpt.dll</code> on Windows or <code>pbtk1cpt.so</code> on other systems) and R file (<code>pbtk1cpt_inits.R</code>) with default input parameters and initial state settings with the definition of <code>application = &quot;R&quot;</code>.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1">mName &lt;-<span class="st"> &quot;pbtk1cpt&quot;</span></a>
<a class="sourceLine" id="cb2-2" title="2"><span class="kw">compile_model</span>(mName, <span class="dt">application =</span> <span class="st">&quot;R&quot;</span>)</a>
<a class="sourceLine" id="cb2-3" title="3"><span class="kw">source</span>(<span class="kw">paste0</span>(mName, <span class="st">&quot;_inits.R&quot;</span>))</a></code></pre></div>
<p>The parameter values and initial states can be customized to specify the properties and schedule for the given dosing scenario.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1">parms &lt;-<span class="st"> </span><span class="kw">initParms</span>()</a>
<a class="sourceLine" id="cb3-2" title="2">parms[<span class="st">&quot;vdist&quot;</span>] &lt;-<span class="st"> </span><span class="fl">0.74</span></a>
<a class="sourceLine" id="cb3-3" title="3">parms[<span class="st">&quot;ke&quot;</span>] &lt;-<span class="st"> </span><span class="fl">0.28</span></a>
<a class="sourceLine" id="cb3-4" title="4">parms[<span class="st">&quot;kgutabs&quot;</span>] &lt;-<span class="st"> </span><span class="fl">2.18</span></a>
<a class="sourceLine" id="cb3-5" title="5">initState &lt;-<span class="st"> </span><span class="kw">initStates</span>(<span class="dt">parms=</span>parms)</a>
<a class="sourceLine" id="cb3-6" title="6">initState[<span class="st">&quot;Agutlument&quot;</span>] &lt;-<span class="st"> </span><span class="dv">10</span></a></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">parms</a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" title="1">initState</a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">Outputs</a></code></pre></div>
<p>In the current setting, we assumed the initial condition of the intake chemical to be 10 mol. The <code>initParms</code> and <code>initStates</code> functions were used to customize the parameter values and the initial state that will be used in the <code>solve_fun</code> function. These parameter value can be adopted from the <code>httk</code> package, which includes physico-chemical and drug biological properties for 553 chemicals. In this case, we used the parameter value of theophylline in this example. The given <code>vdist</code>, <code>ke</code>, and <code>kgutabs</code> are 0.74, 0.28, and 2.18, respectively.</p>
<p>Through <code>ode</code> function in <code>deSolve</code> package, we can visualize the pharmacokinetic according to the given parameter conditions such as time points (<code>times</code>):</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1">times &lt;-<span class="st"> </span><span class="kw">seq</span>(<span class="dt">from =</span> <span class="fl">0.01</span>, <span class="dt">to =</span> <span class="fl">24.01</span>, <span class="dt">by =</span> <span class="dv">1</span>)</a>
<a class="sourceLine" id="cb7-2" title="2">y &lt;-<span class="st"> </span>deSolve<span class="op">::</span><span class="kw">ode</span>(initState, times, <span class="dt">func =</span> <span class="st">&quot;derivs&quot;</span>, <span class="dt">parms =</span> parms, </a>
<a class="sourceLine" id="cb7-3" title="3">                  <span class="dt">dllname =</span> mName, <span class="dt">initfunc =</span> <span class="st">&quot;initmod&quot;</span>, <span class="dt">nout =</span> <span class="dv">1</span>, <span class="dt">outnames =</span> Outputs)</a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="kw">plot</span>(y)</a></code></pre></div>
<p>To conduct sensitivity analysis for the parameters in one-compartment pharmacokinetic model in this case, we want to quantify the impact of these three parameters on the chemical concentration in plasma during 24-hour time period post intake. We assume a uniform distribution for the estimate for each parameter with the coefficient of uncertainty within 50%. The parameter ranges are assumed to be (0.37, 1.12) for <code>vdist</code>, (0.0058, 0.0174) for <code>ke</code>, and (0.045, 0.136) for <code>kgutabs</code>. The sample number determines the robustness of the result of sensitivity analysis. Higher sample numbers can generate narrow confidence intervals for sensitivity measurements across different replications. However, they might cause heavy computational burden for complex models. Here we use a sample number of 400 with 20 replications:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">LL &lt;-<span class="st"> </span><span class="fl">0.5</span> </a>
<a class="sourceLine" id="cb9-2" title="2">UL &lt;-<span class="st"> </span><span class="fl">1.5</span></a>
<a class="sourceLine" id="cb9-3" title="3">q &lt;-<span class="st"> &quot;qunif&quot;</span></a>
<a class="sourceLine" id="cb9-4" title="4">q.arg &lt;-<span class="st"> </span><span class="kw">list</span>(<span class="kw">list</span>(<span class="dt">min =</span> parms[<span class="st">&quot;vdist&quot;</span>] <span class="op">*</span><span class="st"> </span>LL, <span class="dt">max =</span> parms[<span class="st">&quot;vdist&quot;</span>] <span class="op">*</span><span class="st"> </span>UL),</a>
<a class="sourceLine" id="cb9-5" title="5">             <span class="kw">list</span>(<span class="dt">min =</span> parms[<span class="st">&quot;ke&quot;</span>] <span class="op">*</span><span class="st"> </span>LL, <span class="dt">max =</span> parms[<span class="st">&quot;ke&quot;</span>] <span class="op">*</span><span class="st"> </span>UL), </a>
<a class="sourceLine" id="cb9-6" title="6">             <span class="kw">list</span>(<span class="dt">min =</span> parms[<span class="st">&quot;kgutabs&quot;</span>] <span class="op">*</span><span class="st"> </span>LL, <span class="dt">max =</span> parms[<span class="st">&quot;kgutabs&quot;</span>] <span class="op">*</span><span class="st"> </span>UL)) </a>
<a class="sourceLine" id="cb9-7" title="7"><span class="kw">set.seed</span>(<span class="dv">1234</span>)</a>
<a class="sourceLine" id="cb9-8" title="8">params &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;vdist&quot;</span>, <span class="st">&quot;ke&quot;</span>, <span class="st">&quot;kgutabs&quot;</span>)</a>
<a class="sourceLine" id="cb9-9" title="9">x &lt;-<span class="st"> </span><span class="kw">rfast99</span>(params, <span class="dt">n =</span> <span class="dv">200</span>, <span class="dt">q =</span> q, <span class="dt">q.arg =</span> q.arg, <span class="dt">replicate =</span> <span class="dv">20</span>)</a></code></pre></div>
<p>Because the pharmacokinetic model is being used to describe a continuous process for the chemical concentration over time, the sensitivity measurements can also show the time-dependent relationships for each model parameter. Here we define the output time points to examine the change of the parameter sensitivity over time. To solve the pharmacokinetic model through deSolve, we need to provide the details of the argument:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1">out &lt;-<span class="st"> </span><span class="kw">solve_fun</span>(x, times, <span class="dt">initState =</span> initState, <span class="dt">outnames =</span> Outputs, <span class="dt">dllname =</span> mName)</a></code></pre></div>
<p>To create the time-dependent sensitivity measurement, we set the time duration from 0.01 to 24.01 hours in the example. The <code>initParmsfun</code> is used to generate the sampling value for each parameter. The <code>outnames</code>, <code>dllname</code>, <code>func</code>, <code>initfunc</code> are based on the arguments from the ode function in <code>deSolve</code> package. The details of the model structure and these arguments are defined in <code>pbtk1comp.c</code>. and <code>pbtk1comp_inits.R</code>. Finally, the <code>tell2</code> function is used to integrate the parameter values and the output results of numerical analysis that were generated and stored in variables x and y. The result of object x is an object of rfast99, which has specific <code>print</code>, <code>plot</code>, and <code>check</code> method. The print function gives the sensitivity and convergence indices for main, interaction, and total order at each time point. In addition to print out the result of sensitivity analysis, the more efficient way to distinguish the influence of model parameter is to visualize them. The time-dependent sensitivity indices are shown in Figure 2.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1"><span class="kw">plot</span>(out)</a></code></pre></div>
<p>Here, we can find that <code>vdist</code> and <code>ke</code> are dominating the plasma concentration in the before and after 5-hour post chemical intake, respectively, representing that the elimination is a key parameter to dominate the plasma concentration. Besides, the <code>kgutabs</code> only plays a crucial role to determine the plasma concentration in the first hour. The relationship between concentration and the parameters can be plotted as follow (Figure 3):</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="kw">par</span>(<span class="dt">mfrow =</span> <span class="kw">c</span>(<span class="dv">3</span>,<span class="dv">3</span>), <span class="dt">mar =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">2</span>), <span class="dt">oma =</span> <span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>))</a>
<a class="sourceLine" id="cb12-2" title="2"><span class="kw">plot</span>(x<span class="op">$</span>a[,<span class="dv">1</span>,<span class="st">&quot;vdist&quot;</span>], out<span class="op">$</span>y[,<span class="dv">1</span>,<span class="st">&quot;0.01&quot;</span>,], <span class="dt">main =</span> <span class="st">&quot;vdist&quot;</span>)</a>
<a class="sourceLine" id="cb12-3" title="3"><span class="kw">text</span>(<span class="dv">1</span>, <span class="fl">.7</span>, <span class="st">&quot;t=0.01&quot;</span>,<span class="dt">cex =</span> <span class="fl">1.2</span>)</a>
<a class="sourceLine" id="cb12-4" title="4"><span class="kw">plot</span>(x<span class="op">$</span>a[,<span class="dv">1</span>,<span class="st">&quot;ke&quot;</span>], out<span class="op">$</span>y[,<span class="dv">1</span>,<span class="st">&quot;0.01&quot;</span>,], <span class="dt">main =</span> <span class="st">&quot;ke&quot;</span>)</a>
<a class="sourceLine" id="cb12-5" title="5"><span class="kw">plot</span>(x<span class="op">$</span>a[,<span class="dv">1</span>,<span class="st">&quot;kgutabs&quot;</span>], out<span class="op">$</span>y[,<span class="dv">1</span>,<span class="st">&quot;0.01&quot;</span>,], <span class="dt">main =</span> <span class="st">&quot;kgutabs&quot;</span>)</a>
<a class="sourceLine" id="cb12-6" title="6"><span class="kw">plot</span>(x<span class="op">$</span>a[,<span class="dv">1</span>,<span class="st">&quot;vdist&quot;</span>], out<span class="op">$</span>y[,<span class="dv">1</span>,<span class="st">&quot;2.01&quot;</span>,])</a>
<a class="sourceLine" id="cb12-7" title="7"><span class="kw">text</span>(<span class="dv">1</span>, <span class="dv">18</span>, <span class="st">&quot;t=2.01&quot;</span>,<span class="dt">cex =</span> <span class="fl">1.2</span>)</a>
<a class="sourceLine" id="cb12-8" title="8"><span class="kw">plot</span>(x<span class="op">$</span>a[,<span class="dv">1</span>,<span class="st">&quot;ke&quot;</span>], out<span class="op">$</span>y[,<span class="dv">1</span>,<span class="st">&quot;2.01&quot;</span>,])</a>
<a class="sourceLine" id="cb12-9" title="9"><span class="kw">plot</span>(x<span class="op">$</span>a[,<span class="dv">1</span>,<span class="st">&quot;kgutabs&quot;</span>], out<span class="op">$</span>y[,<span class="dv">1</span>,<span class="st">&quot;2.01&quot;</span>,])</a>
<a class="sourceLine" id="cb12-10" title="10"><span class="kw">plot</span>(x<span class="op">$</span>a[,<span class="dv">1</span>,<span class="st">&quot;vdist&quot;</span>], out<span class="op">$</span>y[,<span class="dv">1</span>,<span class="st">&quot;24.01&quot;</span>,])</a>
<a class="sourceLine" id="cb12-11" title="11"><span class="kw">text</span>(<span class="dv">1</span>, <span class="fl">.7</span>, <span class="st">&quot;t=24.01&quot;</span>,<span class="dt">cex =</span> <span class="fl">1.2</span>)</a>
<a class="sourceLine" id="cb12-12" title="12"><span class="kw">plot</span>(x<span class="op">$</span>a[,<span class="dv">1</span>,<span class="st">&quot;ke&quot;</span>], out<span class="op">$</span>y[,<span class="dv">1</span>,<span class="st">&quot;24.01&quot;</span>,])</a>
<a class="sourceLine" id="cb12-13" title="13"><span class="kw">plot</span>(x<span class="op">$</span>a[,<span class="dv">1</span>,<span class="st">&quot;kgutabs&quot;</span>], out<span class="op">$</span>y[,<span class="dv">1</span>,<span class="st">&quot;24.01&quot;</span>,])</a>
<a class="sourceLine" id="cb12-14" title="14"><span class="kw">mtext</span>(<span class="st">&quot;parameter&quot;</span>, SOUTH&lt;-<span class="dv">1</span>, <span class="dt">line=</span><span class="fl">0.4</span>, <span class="dt">outer=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-15" title="15"><span class="kw">mtext</span>(<span class="st">&quot;Ccompartment&quot;</span>, WEST&lt;-<span class="dv">2</span>, <span class="dt">line=</span><span class="fl">0.4</span>, <span class="dt">outer=</span><span class="ot">TRUE</span>)</a></code></pre></div>
<p>The x is a list of class “rfast99”, containing all the input arguments detailed before and the calculated sensitivity indices of first order (<code>mSI</code>), interaction (<code>iSI</code>), and total order (<code>tSI</code>). The convergence indices are also stored in the list named <code>mCI</code>, <code>iCI</code>, and <code>tCI</code>. The parameter values are stored in an array <code>x$a</code> with c(model evaluation, replication, parameters).</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1"><span class="kw">dim</span>(x<span class="op">$</span>a)</a></code></pre></div>
<p>In addition, the output are also formated with c(model evaluation, replication, time, variable).</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1"><span class="kw">dim</span>(out<span class="op">$</span>y)</a></code></pre></div>
<p>The <code>check()</code> is a useful function to determine which parameters have relative lower sensitivity measurement across the given time interval, and therefore can be applied parameter fixing in model calibration. The argument of <code>SI.cutoff</code> is setting at 0.5 to detect the relative non-influential parameters in this case.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" title="1"><span class="kw">check</span>(out, <span class="dt">SI.cutoff =</span> <span class="fl">0.5</span>)</a></code></pre></div>
<p>Based on the sensitivity measurement of the total order, the result shows that <code>kgutabs</code> has relative lower measurement of sensitivity index.</p>
</div>
<div id="model-implementations-with-gnu-mcsim" class="section level2">
<h2>Model implementations with GNU MCSim</h2>
<p>Alternatively, to solve ODE by using GNU MCSim, we need to change the argument to <code>application = mcsim</code> in <code>compile_model()</code>. Rather than apply R <code>deSolve</code> to solve differential equations, the GNU MCSim can provide higher computational speed in global sensitivity analysis.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1"><span class="kw">system.time</span>(y&lt;-<span class="kw">solve_fun</span>(x, times, <span class="dt">initState =</span> initState, <span class="dt">outnames =</span> Outputs, <span class="dt">dllname =</span> mName))</a></code></pre></div>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">compile_model</span>(mName, <span class="dt">application =</span> <span class="st">&quot;mcsim&quot;</span>)</a></code></pre></div>
<p>Sililiar to <code>solve_fun</code> that can define the initial parameter and state values through input function, the <code>solve_mcsim</code> has a <code>condition</code> argument that is used to givien the specific input value such as oral dose or fixing parameter value or initial state variable.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" title="1">conditions &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;Agutlument = 10&quot;</span>) <span class="co"># Set the initial state of Agutlument = 10 </span></a>
<a class="sourceLine" id="cb18-2" title="2"><span class="kw">system.time</span>(y&lt;-<span class="kw">solve_mcsim</span>(x, <span class="dt">mName =</span> mName, </a>
<a class="sourceLine" id="cb18-3" title="3">                           <span class="dt">params =</span> params,</a>
<a class="sourceLine" id="cb18-4" title="4">                           <span class="dt">vars =</span> Outputs,</a>
<a class="sourceLine" id="cb18-5" title="5">                           <span class="dt">time =</span> times,</a>
<a class="sourceLine" id="cb18-6" title="6">                           <span class="dt">condition =</span> conditions))</a></code></pre></div>
<p>Under the same given condition, it takes 5-6 (<code>deSolve</code>) and 1-2 (GNU MCSim) seconds to solve model. The <code>solve_mcsim()</code> shows the better computational performance than <code>solve_fun()</code> in <code>pksensi</code>.</p>
</div>
<div id="references" class="section level2 unnumbered">
<h2>References</h2>
<div id="refs" class="references">
<div id="ref-JSSv002i09">
<p>Bois, Frederic, and Don Maszle. 1997. “MCSim: A Monte Carlo Simulation Program.” <em>Journal of Statistical Software, Articles</em> 2 (9): 1–60. <a href="https://doi.org/10.18637/jss.v002.i09">https://doi.org/10.18637/jss.v002.i09</a>.</p>
</div>
<div id="ref-JSSv079i04">
<p>Pearce, Robert, R. Woodrow Setzer, Cory Strope, Nisha Sipes, and John Wambaugh. 2017. “httk: R Package for High-Throughput Toxicokinetics.” <em>Journal of Statistical Software, Articles</em> 79 (4): 1–26. <a href="https://doi.org/10.18637/jss.v079.i04">https://doi.org/10.18637/jss.v079.i04</a>.</p>
</div>
<div id="ref-JSSv033i09">
<p>Soetaert, Karline, Thomas Petzoldt, and R. Woodrow Setzer. 2010. “Solving Differential Equations in R: Package deSolve.” <em>Journal of Statistical Software, Articles</em> 33 (9): 1–25. <a href="https://doi.org/10.18637/jss.v033.i09">https://doi.org/10.18637/jss.v033.i09</a>.</p>
</div>
</div>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
